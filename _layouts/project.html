---
layout: default
---
{% assign r2 = site.r2_base | default: '' %}

<article class="project">
  <header class="project-header">
    <h1>{{ page.title }}</h1>
    <ul class="meta">
      {% if page.category %}<li class="pill">{{ page.category | capitalize }}</li>{% endif %}
      {% if page.role %}<li>{{ page.role }}</li>{% endif %}
      {% if page.year %}<li>{{ page.year }}</li>{% endif %}
    </ul>

    {% comment %} Cover image: either local URL (page.cover) or filename in bucket (page.cover_file) {% endcomment %}
    {% assign cover_url = page.cover %}
    {% if page.cover_file and r2 != '' %}
      {% capture cover_url %}{{ r2 }}/{{ page.cover_file | uri_escape }}{% endcapture %}
    {% endif %}
    {% if cover_url and cover_url != '' %}
      <img class="cover" src="{{ cover_url }}" alt="{{ page.title }} cover">
    {% endif %}
  </header>

  <section class="project-body">
    {{ content }}
  </section>

  {% if page.gallery or page.gallery_files %}
  <section class="project-gallery">
    {% assign imgs = page.gallery %}
    {% if page.gallery_files %}
      {% assign imgs = page.gallery_files %}
    {% endif %}

    {% for item in imgs %}
      {% assign url = item %}
      {% unless url contains '://' or url startswith '/' %}
        {% if r2 != '' %}
          {% capture url %}{{ r2 }}/{{ item | uri_escape }}{% endcapture %}
        {% endif %}
      {% endunless %}
      <a class="lb" href="{{ url }}"><img src="{{ url }}" loading="lazy" alt=""></a>
    {% endfor %}
  </section>
  {% endif %}

  {% comment %} Video: prefer youtube_id; else absolute page.video; else filename page.video_file {% endcomment %}
  {% if page.youtube_id %}
  <section class="project-video">
    <div class="video-embed">
      <iframe src="https://www.youtube.com/embed/{{ page.youtube_id }}" title="YouTube video" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    </div>
  </section>
  {% elsif page.video %}
  <section class="project-video">
    <video controls preload="metadata" {% if page.poster or page.poster_file %}poster="{% if page.poster_file and r2 != '' %}{{ r2 }}/{{ page.poster_file | uri_escape }}{% else %}{{ page.poster }}{% endif %}"{% endif %}>
      <source src="{{ page.video }}" type="video/mp4">
    </video>
  </section>
  {% elsif page.video_file and r2 != '' %}
  <section class="project-video">
    <video controls preload="metadata" {% if page.poster_file %}poster="{{ r2 }}/{{ page.poster_file | uri_escape }}"{% endif %}>
      <source src="{{ r2 }}/{{ page.video_file | uri_escape }}" type="video/mp4">
      Your browser does not support the video tag.
    </video>
  </section>
  {% endif %}
</article>
